<div class="gestion-container">

  <aside class="gestion-sidebar">

    <div class="sidebar-panel">
      <h3>Buscar Libros</h3>
      <div class="busqueda-container">
        <input
          type="text"
          placeholder="Buscar por título o autor..."
          [(ngModel)]="terminoBusqueda"
          (keyup.enter)="cargarLibros()">
        <button (click)="cargarLibros()">Buscar</button>
      </div>
    </div>

    <div class="sidebar-panel" *ngIf="esAdmin">
      <h3>Agregar Nuevo Libro</h3>

      <form class="formulario-vertical" (submit)="agregarLibro()">

        <div class="form-group">
          <label for="addTitulo">Título</label>
          <input id="addTitulo" type="text" placeholder="Ej: El Quijote" [(ngModel)]="nuevoLibro.titulo" name="titulo" required />
        </div>
        <div class="form-group">
          <label for="addAutor">Autor</label>
          <input id="addAutor" type="text" placeholder="Ej: Cervantes" [(ngModel)]="nuevoLibro.autor" name="autor" required />
        </div>
        <div class="form-group">
          <label for="addGenero">Género</label>
          <input id="addGenero" type="text" placeholder="Ej: Novela" [(ngModel)]="nuevoLibro.genero" name="genero" />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="addAno">Año</label>
            <input id="addAno" type="number" placeholder="Ej: 1605" [(ngModel)]="nuevoLibro.ano" name="ano" />
          </div>
          <div class="form-group">
            <label for="addCantidad">Copias</label>
            <input id="addCantidad" type="number" placeholder="Ej: 5" [(ngModel)]="nuevoLibro.cantidad" name="cantidad" />
          </div>
        </div>

        <button type="submit" class="btn-agregar">Agregar Libro</button>
      </form>
    </div>

  </aside>

  <section class="gestion-content">

    <div class="content-panel">
      <h2 *ngIf="esAdmin">Gestión de Libros</h2>
      <h2 *ngIf="!esAdmin">Catálogo de Libros</h2>

      <div class="tabla-container">
        <table class="tabla">
          <thead>
            <tr>
              <th>Título</th>
              <th>Autor</th>
              <th>Género</th>
              <th>Año</th>
              <th>Disponibles</th>
              <th>Disponibilidad</th>
              <th *ngIf="esAdmin">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let libro of libros">
              <td>{{ libro.titulo }}</td>
              <td>{{ libro.autor }}</td>
              <td>{{ libro.genero }}</td>
              <td>{{ libro.ano }}</td>
              <td>{{ libro.cantidad }}</td>
              <td>
                <span [class.disponible]="libro.cantidad > 0"
                      [class.agotado]="libro.cantidad === 0">
                  {{ libro.cantidad > 0 ? 'Disponible' : 'Agotado' }}
                </span>
              </td>
              <td *ngIf="esAdmin">
                <button class="btn-editar" (click)="editarLibro(libro)">Editar</button>
                <button class="btn-eliminar" (click)="eliminarLibro(libro)">Eliminar</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div> </div> </section> </div> <div class="modal-backdrop" *ngIf="libroSeleccionado">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Editar Libro</h2>
      <button (click)="cerrarModal()" class="close-button">&times;</button>
    </div>
    <div class="modal-body" *ngIf="libroSeleccionado">
      <div class="form-group">
        <label for="editTitulo">Título</label>
        <input id="editTitulo" type="text" [(ngModel)]="libroSeleccionado.titulo" name="titulo">
      </div>
      <div class="form-group">
        <label for="editAutor">Autor</label>
        <input id="editAutor" type="text" [(ngModel)]="libroSeleccionado.autor" name="autor">
      </div>
      <div class="form-group">
        <label for="editGenero">Género</label>
        <input id="editGenero" type="text" [(ngModel)]="libroSeleccionado.genero" name="genero">
      </div>
      <div class="form-group">
        <label for="editAno">Año</label>
        <input id="editAno" type="number" [(ngModel)]="libroSeleccionado.ano" name="ano">
      </div>
      <div class="form-group">
        <label for="editCantidad">Cantidad</label>
        <input id="editCantidad" type="number" [(ngModel)]="libroSeleccionado.cantidad" name="cantidad">
      </div>
    </div>
    <div class="modal-footer">
      <button (click)="cerrarModal()" class="btn-cancelar">Cancelar</button>
      <button (click)="guardarCambios()" class="btn-guardar">Guardar Cambios</button>
    </div>
  </div>
</div>
